# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
# SQ    ### after removing comparison with missing data network has 2 subnetworks
DPs1 <- DPs[-grep("chlormethiazole|triazolam|loprazolam|nitrazepam|zopiclone",DPs$treat2),]
# SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs1, sm="SMD",r="pbo",comb.fixed =F, comb.random = T, details.chkmultiarm=TRUE)
DPs1[,c("studlab","rho")]
DPs1[DPs1$studlab==18,"rho"] <- 0.9
DPs1[DPs1$Crossoverstudy==1 & DPs1$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs1$n1+(DPs1$TE^2)/(2*DPs1$n1))*(2-2*DPs1$rho))[DPs1$Crossoverstudy==1 & DPs1$`crossover, not first phase used`==1]
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs1, sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
SQ1
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoClean27.6eVirgiRenamedIntervSideEffectsClean", na = "NA")
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoClean27.6eVirgiRenamedIntervSideEffectsClean.xlsx", na = "NA")
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepQualityScaleMean,sd=SleepQualityScaleSD,n=SleepQualityScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat1!="BBT I" & treat1!="auricular acupuncture")
DPs <- DPs[-grep("LAT|MAT|acupressure|waitlist|therapeutic|hygiene|juice",DPs$treat2),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","squal_PorF-value","squal_p=0, f=1")]
# use threshold value for those with p-value <0.025
DPs[DPs$studlab==17, "squal_PorF-value"] <- 0.02499
# remove studies for which no p-value available
DPs <- DPs[DPs$studlab!=94 & DPs$studlab!=21,]
# now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`squal_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+(DPs$TE^2)/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
#   EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)
### gives error: Problems in multi-arm studies! Studies with negative treatment   arm variance: '18', '185'
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
# SQ    ### after removing comparison with missing data network has 2 subnetworks
DPs1 <- DPs[-grep("chlormethiazole|triazolam|loprazolam|nitrazepam|zopiclone",DPs$treat2),]
# SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs1, sm="SMD",r="pbo",comb.fixed =F, comb.random = T, details.chkmultiarm=TRUE)
DPs1[,c("studlab","rho")]
DPs1[DPs1$studlab==18,"rho"] <- 0.9
DPs1[DPs1$Crossoverstudy==1 & DPs1$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs1$n1+(DPs1$TE^2)/(2*DPs1$n1))*(2-2*DPs1$rho))[DPs1$Crossoverstudy==1 & DPs1$`crossover, not first phase used`==1]
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs1, sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepQualityScaleMean,sd=SleepQualityScaleSD,n=SleepQualityScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "SMD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- subset(DATApairs, treat1!="BBT I" & treat1!="auricular acupuncture")
DPs <- DPs[-grep("LAT|MAT|acupressure|waitlist|therapeutic|hygiene|juice",DPs$treat2),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","squal_PorF-value","squal_p=0, f=1")]
# use threshold value for those with p-value <0.025
DPs[DPs$studlab==17, "squal_PorF-value"] <- 0.02499
# remove studies for which no p-value available
DPs <- DPs[DPs$studlab!=94 & DPs$studlab!=21,]
# now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`squal_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+(DPs$TE^2)/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
#   EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)
### gives error: Problems in multi-arm studies! Studies with negative treatment   arm variance: '18', '185'
# assign other correlation value to study 18 and 185 based on other studies
# DPs[,c("studlab","rho")]
# DPs[DPs$studlab==18|DPs$studlab==185,"rho"] <- 0.9
# DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs$n1+DPs$TE/(2*DPs$n1))*(2-2*DPs$rho))[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# SQ<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs, sm="SMD",r="nitrazepam",comb.fixed =F, comb.random = T)
# SQ    ### after removing comparison with missing data network has 2 subnetworks
DPs1 <- DPs[-grep("chlormethiazole|triazolam|loprazolam|nitrazepam|zopiclone",DPs$treat2),]
# SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs1, sm="SMD",r="pbo",comb.fixed =F, comb.random = T, details.chkmultiarm=TRUE)
DPs1[,c("studlab","rho")]
DPs1[DPs1$studlab==18,"rho"] <- 0.9
DPs1[DPs1$Crossoverstudy==1 & DPs1$`crossover, not first phase used`==1,"seTE"] <- sqrt((1/DPs1$n1+(DPs1$TE^2)/(2*DPs1$n1))*(2-2*DPs1$rho))[DPs1$Crossoverstudy==1 & DPs1$`crossover, not first phase used`==1]
SQ1<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs1, sm="SMD",r="pbo",comb.fixed =F, comb.random = T)
SQ1
knitr::opts_chunk$set(echo = TRUE)
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm= "MD")
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|midazolam|hygiene|juice",DATApairs$treat1),]
# remove studies with "special patients" that should not be included in main analysis
DPs <- DPs[DPs$Included==1,]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`tst_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
#   EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)
### gives error: Problems in multi-arm studies! Studies with negative treatment   arm variance: '18', '185'
# assign correlation value to study 18 and 185 based on other studies to fix issues with negative variances
DPs$rho <- 0.9
DPs$SDd <- sqrt(DPs$sd1^2 + DPs$sd2^2 - 2*DPs$rho*DPs$sd1*DPs$sd2)
DPs[DPs$studlab==18 | DPs$studlab==185,"seTE"] <- (DPs$SDd/sqrt(DPs$n1))[DPs$studlab==18 | DPs$studlab==185]
TST<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.5)
TST
netleague(TST)
#forest plots
netleague(SQ1)
knitr::opts_chunk$set(echo = TRUE, fig.width = 8, fig.height = 3)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=SleepTimeTotalScaleMean,sd=SleepTimeTotalScaleSD,n=SleepTimeTotalScaleParticipants, data=DATA, studlab = Final_ID_all, sm="MD")
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#check p-value availability for paired t-test for crossover studies with both phases used
DATApairs[DATApairs$Crossoverstudy==1 & DATApairs$`crossover, not first phase used`==1,c("studlab","tst_PorF-value","tst_p=0, f=1")]
# use threshold value for those with p-value <0.001
DATApairs[DATApairs$studlab==185, "tst_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DATApairs$tvalue <- qt(as.numeric(DATApairs$`tst_PorF-value`)/2, df=DATApairs$n1-1, lower.tail = F)
#DATApairs$SDd <- abs((DATApairs$mean2-DATApairs$mean1)/DATApairs$tvalue*sqrt(DATApairs$n1))
#DATApairs$rho <- (DATApairs$sd1^2 + DATApairs$sd2^2 - DATApairs$SDd^2)/(2*DATApairs$sd1*DATApairs$sd2)
DATApairs[DATApairs$Crossoverstudy==1 & DATApairs$`crossover, not first phase used`==1,"seTE"] <- (abs(DATApairs$TE)/DATApairs$tvalue)[DATApairs$Crossoverstudy==1 & DATApairs$`crossover, not first phase used`==1]
write.csv(DATApairs, file = "~/Virginia/NMA insomnia/TotalSleepTime_pairwise")
write.csv(DATApairs, file = "~/Virginia/NMA insomnia/TotalSleepTime_pairwise.csv")
A <- read.csv("~/Virginia/NMA insomnia/TotalSleepTime_pairwise.csv")
View(A)
View(A)
rm(A)
write.csv(DATApairs, file = "~/Virginia/NMA insomnia/TotalSleepTime_pairwise.csv")
write.csv(DATApairs, file = "~/Virginia/NMA insomnia/TotalSleepTime_pairwise.csv")
knitr::opts_chunk$set(echo = TRUE, fig.width = 8, fig.height = 3)
write.csv(DATApairs, file = "~/Virginia/NMA insomnia/SleepQuality_pairwise.csv")
knitr::opts_chunk$set(echo = TRUE)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=WakeAfterSleepOnsetScaleMean, sd=WakeAfterSleepOnsetScaleSD, n=WakeAfterSleepOnsetScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|juice",DATApairs$treat1),]
# remove studies with "special patients" that should not be included in main analysis
# DPs <- DPs[DPs$Included==1,]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","waso_PorF-value","waso_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Garfinkel 1995", "waso_PorF-value"] <- 0.00099
#now calculate adjusted SE for crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`waso_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# check there is no NA is the data
DPs[is.na(DPs$TE) | is.na(DPs$seTE),c("studlab","treat1","treat2","TE","seTE")]
WASO<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T)
WASO
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=WakeAfterSleepOnsetScaleMean, sd=WakeAfterSleepOnsetScaleSD, n=WakeAfterSleepOnsetScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","waso_PorF-value","waso_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Garfinkel 1995", "waso_PorF-value"] <- 0.00099
#now calculate adjusted SE for crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`waso_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# check there is no NA is the data
DPs[is.na(DPs$TE) | is.na(DPs$seTE),c("studlab","treat1","treat2","TE","seTE")]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#get the data and select them
DATA <- read_excel("~/Virginia/NMA insomnia/Insomnia/MyrtoIncludedAllOutcomesClean27.6dVirgiRenamedInterventions.xlsx", na = "NA")
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=WakeAfterSleepOnsetScaleMean, sd=WakeAfterSleepOnsetScaleSD, n=WakeAfterSleepOnsetScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","waso_PorF-value","waso_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Garfinkel 1995", "waso_PorF-value"] <- 0.00099
#now calculate adjusted SE for crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`waso_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# check there is no NA is the data
DPs[is.na(DPs$TE) | is.na(DPs$seTE),c("studlab","treat1","treat2","TE","seTE")]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=WakeAfterSleepOnsetScaleMean, sd=WakeAfterSleepOnsetScaleSD, n=WakeAfterSleepOnsetScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","waso_PorF-value","waso_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Garfinkel 1995", "waso_PorF-value"] <- 0.00099
#now calculate adjusted SE for crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`waso_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# check there is no NA is the data
DPs[is.na(DPs$TE) | is.na(DPs$seTE),c("studlab","treat1","treat2","TE","seTE")]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|juice",DATApairs$treat1),]
# remove studies with "special patients" that should not be included in main analysis
# DPs <- DPs[DPs$Included==1,]
WASO<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T)
WASO
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=WakeAfterSleepOnsetScaleMean, sd=WakeAfterSleepOnsetScaleSD, n=WakeAfterSleepOnsetScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
View(DATApairs)
# check there is no NA is the data
DATApairs[is.na(DATApairs$TE) | is.na(DATApairs$seTE),c("studlab","treat1","treat2","TE","seTE")]
# check there is no NA is the data
DPs <- DATApairs[is.na(DATApairs$TE) | is.na(DATApairs$seTE),c("studlab","treat1","treat2","TE","seTE")]
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & is.na(DATApairs$seTE),c("studlab","treat1","treat2","TE","seTE")]
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),c("studlab","treat1","treat2","TE","seTE")]
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","waso_PorF-value","waso_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Garfinkel 1995", "waso_PorF-value"] <- 0.00099
#now calculate adjusted SE for crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`waso_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|juice",DATApairs$treat1),]
WASO<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=WakeAfterSleepOnsetScaleMean, sd=WakeAfterSleepOnsetScaleSD, n=WakeAfterSleepOnsetScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","waso_PorF-value","waso_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Garfinkel 1995", "waso_PorF-value"] <- 0.00099
#now calculate adjusted SE for crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`waso_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DPs[-grep("LAT|MAT|BBT I|juice",DATApairs$treat1),]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
WASO<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T)
knitr::opts_chunk$set(echo = TRUE)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=SleepOnsetLatencyScaleMean, sd=SleepOnsetLatencyScaleSD, n=SleepOnsetLatencyScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DATApairs[-grep("LAT|MAT|BBT I|flunitrazepam|juice",DATApairs$treat1),]
# remove studies with "special patients" that should not be included in main analysis
# DPs <- DPs[DPs$Included==1,]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Vinkari 1984", "sol_PorF-value1"] <- 0.00099
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Baskett 2003" & DPs$studlab!="Haimov 1995",]
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`sol_PorF-value1`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
#   EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)
### gives error: Problems in multi-arm studies! Studies with negative treatment   arm variance: '18', '185'
# assign correlation value to study 18 and 185 based on other studies to fix issues with negative variances
DPs$rho <- 0.9
DPs$SDd <- sqrt(DPs$sd1^2 + DPs$sd2^2 - 2*DPs$rho*DPs$sd1*DPs$sd2)
DPs[DPs$studlab=="Glass 2008" | DPs$studlab=="Vinkari 1984","seTE"] <- (DPs$SDd/sqrt(DPs$n1))[DPs$studlab=="Glass 2008" | DPs$studlab=="Vinkari 1984"]
# check there is no NA is the data
DPs[is.na(DPs$TE) | is.na(DPs$seTE),c("studlab","treat1","treat2","TE","seTE")]
DPs <- subset(DPs, studlab!="Glind 2014" & studlab!="Ancoli-Israel 1999" )
SOL<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.5)
SOL
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=SleepOnsetLatencyScaleMean, sd=SleepOnsetLatencyScaleSD, n=SleepOnsetLatencyScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
View(DATApairs)
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Vinkari 1984", "sol_PorF-value1"] <- 0.00099
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Haimov 1995",]
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Vinkari 1984", "sol_PorF-value1"] <- 0.00099
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Haimov 1995",]
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`sol_PorF-value1`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DPs[-grep("LAT|MAT|BBT I|flunitrazepam|juice",DATApairs$treat1),]
SOL<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.5)
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DPs[-grep("LAT|MAT|BBT I|flunitrazepam|juice",DPs$treat1),]
DATApairs=pairwise(treat=Drug_name, mean=SleepOnsetLatencyScaleMean, sd=SleepOnsetLatencyScaleSD, n=SleepOnsetLatencyScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Vinkari 1984", "sol_PorF-value1"] <- 0.00099
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Haimov 1995",]
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`sol_PorF-value1`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DPs[-grep("LAT|MAT|BBT I|flunitrazepam|juice",DPs$treat1),]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
SOL<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.5)
# assign correlation value to study 18 and 185 based on other studies to fix issues with negative variances
DPs$rho <- 0.9
DPs$SDd <- sqrt(DPs$sd1^2 + DPs$sd2^2 - 2*DPs$rho*DPs$sd1*DPs$sd2)
DPs[DPs$studlab=="Glass 2008" | DPs$studlab=="Vinkari 1984","seTE"] <- (DPs$SDd/sqrt(DPs$n1))[DPs$studlab=="Glass 2008" | DPs$studlab=="Vinkari 1984"]
SOL<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.5)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=SleepOnsetLatencyScaleMean, sd=SleepOnsetLatencyScaleSD, n=SleepOnsetLatencyScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Vinkari 1984", "sol_PorF-value1"] <- 0.00099
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Haimov 1995",]
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`sol_PorF-value1`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
View(DPs)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=SleepOnsetLatencyScaleMean, sd=SleepOnsetLatencyScaleSD, n=SleepOnsetLatencyScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2","sol_PorF-value1","sol_PorF-value2","sol_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Vinkari 1984", "sol_PorF-value1"] <- 0.00099
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Haimov 1995",]
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`sol_PorF-value1`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
# assign correlation value to study 18 and 185 based on other studies to fix issues with negative variances
DPs$rho <- 0.9
DPs$SDd <- sqrt(DPs$sd1^2 + DPs$sd2^2 - 2*DPs$rho*DPs$sd1*DPs$sd2)
DPs[DPs$studlab=="Glass 2008" | DPs$studlab=="Vinkari 1984","seTE"] <- (DPs$SDd/sqrt(DPs$n1))[DPs$studlab=="Glass 2008" | DPs$studlab=="Vinkari 1984"]
knitr::opts_chunk$set(echo = TRUE)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=Qol_mean, sd=Qol_SD, n=QoL_participants, data=DATA, studlab = Study_name, sm= "SMD")
View(DATApairs)
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
View(DATApairs)
knitr::opts_chunk$set(echo = TRUE)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=PolySomnographyScaleMean, sd=PolySomnographyScaleSD, n=PolySomnographyScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
View(DATApairs)
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2")]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("Study_name","treat1","treat2")]
# no p-value available for this outcome so remove crossover study
DPs <- DPs[DPs$studlab!="Garfinkel 1995",]
View(DPs)
View(DPs)
knitr::opts_chunk$set(echo = TRUE)
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=NocturnalAwakeningsScaleMean,sd=NocturnalAwakeningsScaleSD,n=NocturnalAwakeningsScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
View(DATApairs)
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","Awak_PorF-value","Awak_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Glass 2008", "Awak_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`Awak_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DATApairs,warn = T)
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
#remove rows for studies disconnected from main network
DPs <- DPs[-grep("BBT I|hygiene",DPs$treat1),]
#run NMA and create an object called EFF for efficacy   ### gives error because consists of 5 separate sub-networks so run netconnection first
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
NNA<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="MD",r="pbo",comb.fixed =F, comb.random = T)
# assign correlation value to study 18 and 185 based on other studies to fix issues with negative variances
DPs$rho <- 0.9
#prepare the data
DATApairs=pairwise(treat=Drug_name,mean=NocturnalAwakeningsScaleMean,sd=NocturnalAwakeningsScaleSD,n=NocturnalAwakeningsScaleParticipants, data=DATA, studlab = Study_name, sm= "MD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","Awak_PorF-value","Awak_p=0, f=1")]
# use threshold value for those with p-value <0.001
DPs[DPs$studlab=="Glass 2008", "Awak_PorF-value"] <- 0.00099
#now calculate adjusted SE for remaining crossover studies
DPs$tvalue <- qt(as.numeric(DPs$`Awak_PorF-value`)/2, df=DPs$n1-1, lower.tail = F)
#DPs$SDd <- abs((DPs$mean2-DPs$mean1)/DPs$tvalue*sqrt(DPs$n1))
#DPs$rho <- (DPs$sd1^2 + DPs$sd2^2 - DPs$SDd^2)/(2*DPs$sd1*DPs$sd2)
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,"seTE"] <- (abs(DPs$TE)/DPs$tvalue)[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1]
#   EFF<-netmeta(TE,seTE,treat1,treat2,studlab,data=DPs,  sm="SMD",r="pbo",comb.fixed =F, comb.random = T, tol.multiarm = 0.05, details.chkmultiarm = T)
### gives error: Problems in multi-arm studies! Studies with negative treatment   arm variance: '18', '185'
# assign correlation value to study 18 and 185 based on other studies to fix issues with negative variances
DPs$rho <- 0.9
DPs$SDd <- sqrt(DPs$sd1^2 + DPs$sd2^2 - 2*DPs$rho*DPs$sd1*DPs$sd2)
DPs[DPs$studlab=="Glass 2008","seTE"] <- (DPs$SDd/sqrt(DPs$n1))[DPs$studlab=="Glass 2008"]
knitr::opts_chunk$set(echo = TRUE)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=DayTimeSleepinessScaleMean, sd=DayTimeSleepinessScaleSD, n=DayTimeSleepinessScaleParticipants, data=DATA, studlab = Study_name, sm= "SMD")
View(DATApairs)
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=DayTimeSleepinessScaleMean, sd=DayTimeSleepinessScaleSD, n=DayTimeSleepinessScaleParticipants, data=DATA, studlab = Study_name, sm= "SMD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
# remove studies with "special patients" that should not be included in main analysis
DPs <- DPs[DPs$Included==1,]
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=DayTimeSleepinessScaleMean, sd=DayTimeSleepinessScaleSD, n=DayTimeSleepinessScaleParticipants, data=DATA, studlab = Study_name, sm= "SMD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
View(DPs)
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","Day_PorF-value","Day_p=0, f=1")]
View(DPs)
View(DPs)
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Vinkari 1984" & DPs$studlab!="Vinkari 2010"]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","Day_PorF-value","Day_p=0, f=1")]
# prepare the data
DATApairs=pairwise(treat=Drug_name, mean=DayTimeSleepinessScaleMean, sd=DayTimeSleepinessScaleSD, n=DayTimeSleepinessScaleParticipants, data=DATA, studlab = Study_name, sm= "SMD")
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","Day_PorF-value","Day_p=0, f=1")]
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Vinkari 1984" & DPs$studlab!="Pigeon 2010"]
View(DPs)
# check there is no NA is the data
DPs <- DATApairs[!is.na(DATApairs$TE) & !is.na(DATApairs$seTE),]
#check p-value availability for paired t-test for crossover studies with both phases used
DPs[DPs$Crossoverstudy==1 & DPs$`crossover, not first phase used`==1,c("studlab","Day_PorF-value","Day_p=0, f=1")]
# remove studies wit no p-value
DPs <- DPs[DPs$studlab!="Vinkari 1984" & DPs$studlab!="Pigeon 2010",]
View(DATApairs)
View(DATApairs)
View(DPs)
# run netconnection first to check for potential sub-networks
netconnection(treat1,treat2,studlab,data=DPs,warn = T)
View(DATApairs)
View(DATApairs)
View(DATApairs)
View(DPs)
#remove rows for studies disconnected from main network
DPs <- subset(DPs,treat2!="waitlist")
DPs1 <- DPs[-grep("chlormethiazole|triazolam|loprazolam|nitrazepam|zopiclone",DPs$treat2),]
View(DPs)
